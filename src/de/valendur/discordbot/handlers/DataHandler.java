package de.valendur.discordbot.handlers;

import java.util.Arrays;
import java.util.List;
import de.valendur.discordbot.dbhandlers.DBDataHandler;
import kong.unirest.json.JSONObject;
import net.dv8tion.jda.api.events.message.MessageReceivedEvent;
import net.dv8tion.jda.api.events.user.UserActivityEndEvent;
import net.dv8tion.jda.api.events.user.UserActivityStartEvent;
import net.dv8tion.jda.api.events.user.update.UserUpdateActivityOrderEvent;
import net.dv8tion.jda.api.events.user.update.UserUpdateOnlineStatusEvent;
import net.dv8tion.jda.api.hooks.ListenerAdapter;

public class DataHandler extends ListenerAdapter {
	
	List<String> acceptedMembers = Arrays.asList(new String[]{"269504371140722688","137701911993253888","394649639447560213","251725362273320960","345624585007267841","630094656654540861","395110313545957376","458649366798794776","410983580697624595","729786847227805779","439680389733416971","522286015684280330","429264412600434699","299328418707800064","536209559484629002","361079708223406083","581942952813658134","145240648939732992","481038804166377472","311849140000653333","189065880032903169","395920164048207894","258666727930331136","387264710539476992","791570646395125791","351150285953171468","678582464129662977","406128538941653012","682561840362029109","429594260786905099","431794947499229184","783254934639869953","570168363716837378","793896475977449512","683387147700535332","529990161023631360","780314488615469056","575326197941010462","232144370739052545","323911922233901057","706784418802434079","304695731078299651","459591145744367636","217324750702247936","269848697364414466","297053720699469825","793524959586156566","342292990888378368","304547276813107200","437968012381782025","707869719935582298","535568389813305374","311906878097719318","345248736831602690","249827595569463296","607645404464545916","312232629720055809","454014257345069106","197789138353782785","456508251966799875","328627563280728065","688971078642434081","534044927798018093","356861679491088384","631203397277712389","423859457907228672","545692985573113857","476115190220455976","264311508312260609","592413726494162945","442028067163078666","578806726506184704","585567324011102218","630528930637545473","287965689262768128","520251960461361152","261235200325844992","619557973374664721","154411126518579200","768428649170468905","600016501394636811","130036901234081792","746686281521823765","517732471182196736","329672629126430722","284092202760536064","520666690242215947","315520537138954242","407562189394673699","263066425785057282","511574097923145752","786399174925090858","234395307759108106","744583234515501107","414500020017168394","159985870458322944","666878991835332609","404016237736099840","311841243195768833","378151425517289472","780918287851978783","780935189781020673","257606998894444544","348425546281254913","466256332266274836","670263953380605992","620274783921242112","668037697788444682","296003288917213184","809040229662326814","760198436560568351","209310072650727425","348622725989793793","652581296509288475","599306338706915328","789193599845531718","508697565802528781","356840979556204545","398479243283267584","566605973460877322","217598196849836032","474096476427911180","190125870336311306","664547037400006706","282482656564871171","661208822798614559","818281910685007922","484042476194365448","543509355056857099","572012289839071232","245095716068917258","687602071616094239","429685242429833217","346770836234960907","839122655964692491","656252778846355519","192195028167294976","275594544169615360","786630531328638986","394150052714774539","228511813350850560","492188512939016204","662691672320376842","426401751931813888","230794838998515712","403245862580387850","690512286757945355","689147801719930892","348506995420168193","424910742081241088","367363655647363073","172488201527754753","767387188387905596","762093714427346944","752163190111993926","267053756900704257","740578173250699356","477864354105262083","809786817938325545","780107680089636866","740119383896227880","449564010631659520","278581359918710784","148458130647285760","696831503157559358","510519384670994432","429253276987555840","582920016769318922","442352248853364757","487900770646229033","379239692446597132","138623178934190080","388710239895027713","236572447816548355","767461352792391712","341234826525016064","810933297449795594","700380645997674516","677248237740228647","670700631870406657","299948654314389504","501000050260836383","574995243380768798","535893752716328961","833271129342476288","382189155704111104","812457897010135071","442244009553952789","346632784590405642","346359240996290560","302364183150723073","282723354392133634","682321734724091933","377793305464930324","224577126664372224","327897031358283777","611809978541670440","391253264915496964","293352156696936448","239179561542090752","272850060612468737","410508524074958858","456125686415884288","391261544391901185","277767292404891648","385833844907180033","823885580617252915","820086310063964205","712721348144791682","399340209478565890","584674692502388757","518696755018203167","240147419336146946","777203173190271016","720820938106470412","556583250802507780","268344885499658240","419947553631633438","410415209027600384","636690384709222403","497913815535714315","699633442563817474","748886411620515850","378961854900207631","388728655662153730","569633973064564749","681789834402201631","391740017615306752","439771415764402187","379392539717009410","546679705303121920","244868942626160643","646059431179845642","565931009930166282","505410045027155972","815011226886602754","826540978306416661","673176618990043149","261217236692238337","765825291574575125","833693054472552468","278647246709456906","185017001658417153","350548397033521152","805756762484375634","404381757656399881","221503785925607427","209670415843459072","311654110283825152","143059505201020928","469920417436401715","793964266033905664","231470310841516043","388040832802095106"});

	@Override
	public void onUserActivityEnd(UserActivityEndEvent event) {
		if (event.getUser().isBot() || !acceptedMembers.contains(event.getUser().getId())) return;
		
		
	}

	@Override
	public void onUserActivityStart(UserActivityStartEvent event) {
		if (event.getUser().isBot() || !acceptedMembers.contains(event.getUser().getId())) return;
		
		
	}

	@Override
	public void onUserUpdateActivityOrder(UserUpdateActivityOrderEvent event) {
		if (event.getUser().isBot() || !acceptedMembers.contains(event.getUser().getId())) return;
		
	}

	@Override
	public void onUserUpdateOnlineStatus(UserUpdateOnlineStatusEvent event) {
		if (event.getUser().isBot() || !acceptedMembers.contains(event.getUser().getId())) return;
		
		JSONObject data = new JSONObject();
		data.put("OLD_STATUS", event.getOldOnlineStatus());
		data.put("NEW_STATUS", event.getNewOnlineStatus());
		
		DBDataHandler.addEvent(event.getUser().getId(),EventType.STATUS_UPDATE, data);
		System.out.println(event.getMember().getEffectiveName()+"change their online status to "+ event.getNewOnlineStatus());
	}

	@Override
	public void onMessageReceived(MessageReceivedEvent event) {
		if (event.getAuthor().isBot() || !acceptedMembers.contains(event.getAuthor().getId())) return;
		
		JSONObject data = new JSONObject();
		data.put("CHANNEL_ID", event.getChannel().getId());
		data.put("MESSAGE_LENGTH", event.getMessage().getContentDisplay().length());
		data.put("MESSAGE_CONTENT", event.getMessage().getContentDisplay());
		
		DBDataHandler.addEvent(event.getMember().getId(),EventType.MESSAGE_RECEIVED, data);	
		
	}
	
	

	
}
